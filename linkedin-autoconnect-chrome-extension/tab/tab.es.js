var e=Object.defineProperty,t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,a=(t,r,n)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[r]=n;function o(e,t,r,n){(_(e)||j(e))&&("family"in e||"graphite"in e)||B(`${t}: expect ${r} to be a unit (store, event or effect)${n}`)}function l(e,t,r){if(Array.isArray(e))for(let n=0;n<e.length;n++)o(e[n],t,`${n} item of ${r}`,"");else o(e,t,r," or array of units")}function s({node:e=[],from:t,source:r,parent:n=t||r,to:a,target:o,child:l=a||o,scope:s={},meta:i={},family:c={type:"regular"},regional:u}={}){let f=me(n),d=me(c.links),p=me(c.owners),m=[],g={};for(let h=0;h<e.length;h++){let t=e[h];t&&(m.push(t),ge(t,g))}let y={id:D(),seq:m,next:me(l),meta:i,scope:s,family:{type:c.type||"crosslink",links:d,owners:p},reg:g};for(let h=0;h<d.length;h++)te(d[h]).push(y);for(let h=0;h<p.length;h++)re(p[h]).push(y);for(let h=0;h<f.length;h++)f[h].next.push(y);return u&&fe&&ue(le(fe),[y]),y}function i(e,t,r){let n=qe,a=null,o=Ae;if(e.target&&(t=e.params,r=e.defer,n="page"in e?e.page:n,e.stack&&(a=e.stack),o=ce(e)||o,e=e.target),o&&Ae&&o!==Ae&&(Ae=null),Array.isArray(e))for(let p=0;p<e.length;p++)ve("pure",n,ee(e[p]),a,t[p],o);else ve("pure",n,ee(e),a,t,o);if(r&&!Ne)return;let l,s,i,c,u,f,d={isRoot:Ne,currentPage:qe,forkPage:Ae,isWatch:xe};Ne=0;e:for(;c=we();){let{idx:e,stack:t,type:r}=c;i=t.node,qe=u=t.page,Ae=ce(t),f=(u||i).reg;let n={fail:0,scope:i.scope};l=s=0;for(let a=e;a<i.seq.length&&!l;a++){let o=i.seq[a],c=o.data;switch(o.type){case"barrier":{let n=c.barrierID;u&&(n=`${u.fullID}_${n}`);let o=c.priority;if(a!==e||r!==o){Pe.has(n)||(Pe.add(n),Se(a,t,o,n));continue e}Pe.delete(n);break}case"mov":{let e;switch(c.from){case"stack":e=le(t);break;case"a":case"b":e=t[c.from];break;case"value":e=c.store;break;case v:f[c.store.id]||(t.page=u=_e(u,c.store.id),f=u?u.reg:i.reg),e=V(f[c.store.id])}switch(c.to){case"stack":t.value=e;break;case"a":case"b":t[c.to]=e;break;case v:je(u,i,c.target.id).current=e}break}case"check":switch(c.type){case"defined":s=void 0===le(t);break;case"changed":s=le(t)===V(je(u,i,c.store.id))}break;case"filter":s=!Fe(n,c,t);break;case"run":if(a!==e||"effect"!==r){Se(a,t,"effect");continue e}case"compute":xe="watch"===i.meta.op,t.value=Fe(n,c,t),xe=d.isWatch}l=n.fail||s}if(!l)for(let a=0;a<i.next.length;a++)ve("child",u,i.next[a],t,le(t),ce(t))}Ne=d.isRoot,qe=d.currentPage,Ae=ce(d)}function c(e,t="combine"){let r=t+"(",n="",a=0;for(let o in e){let t=e[o];if(null!=t&&(r+=n,r+=P(t)?t.compositeName.fullName:t.toString()),a+=1,25===a)break;n=", "}return r+=")",r}function u(e,t){for(let r in e)t(e[r],r)}function f(e,t){let r=(e,...t)=>qe?((e,t,r,n)=>{let a=qe,o=null;if(t)for(o=qe;o&&o.template!==t;)o=ie(o);Be(o);let l=e.create(r,n);return Be(a),l})(r,n,e,t):r.create(e,t);r.graphite=s({meta:Xe("event",r,t,e),regional:1}),r.create=e=>(i(Ae?Ae.find(r):r,e),e),r.watch=I(Je,r),r.map=e=>{let t,n;_(e)&&(t=e,n=e.name,e=e.fn);let a=f(Ue(r,n),t);return Ze(r,a,C,e),a},r.filter=e=>et(r,"filter",e.fn?e:e.fn,[G({fn:Z})]),r.filterMap=e=>et(r,"filterMap",e,[W({fn:Z}),H.defined()]),r.prepend=e=>{let t=f("* → "+r.shortName,{parent:ie(r)});return Ze(t,r,"prepend",e),Ve(r,t),t};let n=de();return r}function d(e,t){function r(e,t){u.off(e),se(u).set(e,He(tt(e,u,"on",1,t,p)))}let n=Q(e),a=Q(e),o=Ye("updates");n.after=[{type:"copy",to:a}];let c=n.id,u={subscribers:new Map,updates:o,defaultState:e,stateRef:n,getState(){let e,t=n;if(qe){let t=qe;for(;t&&!t.reg[c];)t=ie(t);t&&(e=t)}return!e&&Ae&&Ae.reg[c]&&(e=Ae),e&&(t=e.reg[c]),V(t)},setState(e){let t;Ae&&(t=Ae.nodeMap[ee(u).id]),t||(t=u),i({target:t,params:e,defer:1})},reset(...e){for(let t of e)u.on(t,(()=>u.defaultState));return u},on(e,t){if(l(e,".on","first argument"),Array.isArray(e))for(let n of e)r(n,t);else r(e,t);return u},off(e){let t=se(u).get(e);return t&&(t(),se(u).delete(e)),u},map(e,t){let r,a,o;_(e)&&(r=e,a=e.name,t=e.firstState,e=e.fn);let l=u.getState();void 0!==l&&(o=e(l,t));let s=d(o,{name:Ue(u,a),config:r,strict:0});return tt(u,s,C,0,e),ne(s).before=[{type:C,fn:e,from:n}],s},watch(e,t){if(!t||!P(e)){let t=Je(u,e);return e(u.getState()),t}return j(t)||B("second argument should be a function"),e.watch((e=>t(u.getState(),e)))}},f=Xe(v,u,t),p=u.defaultConfig.updateFilter;return u.graphite=s({scope:{state:n},node:[H.defined(),H.changed({store:a}),p&&z({store:a,to:"a"}),p&&G({fn:(e,t,{a:r})=>p(e,r)}),K({store:n}),K({store:a})],child:o,meta:f,regional:1}),Qe&&void 0===e&&B("current state can't be undefined, use null instead"),ue(u,[o]),u}function p(...e){let t,r,n;Oe(e[0],((t,r)=>{n=t,e=r}));let a,o,l=e[e.length-1];if(j(l)?(r=e.slice(0,-1),t=l):r=e,1===r.length){let e=r[0];N(e)||(a=e,o=1)}return o||(a=r,t&&(t=rt(t))),_(a)||B("shape should be an object"),nt(Array.isArray(a),a,n,t)}function m(e,t){let r=f(e,t),n=r.defaultConfig.handler||(()=>B(`no handler used in ${r.getType()}`)),a=ee(r);a.meta.onCopy=["runner"],a.meta.unit=r.kind="effect",r.use=e=>(j(e)||B(".use argument should be a function"),n=e,r);let o=r.finally=Ye("finally"),l=r.done=o.filterMap({named:"done",fn({status:e,params:t,result:r}){if("done"===e)return{params:t,result:r}}}),c=r.fail=o.filterMap({named:"fail",fn({status:e,params:t,error:r}){if("fail"===e)return{params:t,error:r}}}),u=r.doneData=l.map({named:"doneData",fn:({result:e})=>e}),p=r.failData=c.map({named:"failData",fn:({error:e})=>e}),m=s({scope:{getHandler:r.use.getCurrent=()=>n,finally:o},node:[J({fn({params:e,req:t},{finally:r,getHandler:n},a){let o,l=at({params:e,req:t,ok:1,anyway:r,stack:a}),s=at({params:e,req:t,ok:0,anyway:r,stack:a});try{o=n()(e)}catch(i){return void s(i)}_(o)&&j(o.then)?o.then(l,s):l(o)}})],meta:{op:"fx",fx:"runner",onCopy:["finally"]}});a.scope.runner=m,a.seq.push(W({fn:(e,t,r)=>ie(r)?{params:e,req:{rs(e){},rj(e){}}}:e}),J({fn:(e,{runner:t},r)=>(i({target:t,params:e,defer:1,forkPage:ce(r)}),e.params)})),r.create=e=>{let t=function(){let e={};return e.req=new Promise(((t,r)=>{e.rs=t,e.rj=r})),e.req.catch((()=>{})),e}(),n={params:e,req:t};if(Ae){if(!xe){let e=Ae;t.req.finally((()=>{Me(e)})).catch((()=>{}))}i(Ae.find(r),n)}else i(r,n);return t.req};let g=r.inFlight=d(0,{named:"inFlight"}).on(r,(e=>e+1)).on(o,(e=>e-1)),y=r.pending=g.map({fn:e=>e>0,named:"pending"});return ue(r,[o,l,c,u,p,y,g,m]),r}function g(e,t){let r=f(t||c(e,"merge"));return l(e,"merge","first argument"),Ge({from:e,to:r,meta:{op:"merge"}}),r}function y(...e){let t,r,n,a,[[o,i,c],u]=De(e);void 0===i&&_(o)&&(e=>{let t=0;return function(e,t){e.forEach(t)}(lt,(r=>{r in e&&(null==e[r]&&B(`sample: ${r} should be defined`),t=1)})),t})(o)&&(i=o.clock,c=o.fn,a=o.greedy,t=o.target,r=o.name,n=o.sid,o=o.source);let m=1;void 0===o&&(l(i,"sample","clock"),Array.isArray(i)&&(i=g(i)),o=i,m=0),m&&!P(o)&&(o=p(o)),void 0===i&&(i=o),l(i,"sample","clock"),r=u||r||o.shortName;let y=de(),h=!!t;t||(t=N(o)&&N(i)?d(c?c(V(ne(o)),V(ne(i))):V(ne(o)),{name:r,sid:n}):f(r));let k=h&&P(t)&&ee(t).meta.nativeTemplate;if(N(o)){let e=ne(o);ue(o,[We(i,t,{scope:{fn:c,targetTemplate:k},node:[y,!a&&T({priority:"sampler"}),z({store:e,to:c?"a":"stack"}),c&&W({fn:Y}),y],meta:{op:"sample",sample:v}})])}else{let e=Q(0),r=Q(),n=Q();s({parent:o,node:[K({store:r}),z({from:"value",store:1,target:e})],family:{owners:[o,t,i],links:t},meta:{op:"sample",sample:"source"},regional:1}),ue(o,[We(i,t,{scope:{fn:c,targetTemplate:k},node:[y,K({store:n}),z({store:e}),G({fn:e=>e}),!a&&T({priority:"sampler"}),z({store:r}),z({store:n,to:"a"}),c&&W({fn:X}),y],meta:{op:"sample",sample:"clock"}})])}return t}function h(...e){let t={op:"guard"},r="guard",[[n,a],o]=De(e);o&&(t.config=o,o.name&&(r=o.name)),a||(a=n,n=a.source);let{filter:i,greedy:c,clock:u,name:d=r}=a,m=a.target||f(d,t.config),h=P(i),k=1;return void 0===n&&(l(u,"guard","clock"),Array.isArray(u)&&(u=g(u)),n=u,k=0),k&&!P(n)&&(n=p(n)),u&&(l(u,"guard","clock"),n=y({source:n,clock:u,greedy:c,fn:h?null:(e,t)=>({source:e,clock:t})})),l(m,"guard","target"),h?y({source:i,clock:n,target:s({node:[G({fn:({guard:e})=>e}),W({fn:({data:e})=>e})],child:m,meta:t,family:{owners:[n,i,m,...[].concat(u||[])],links:m},regional:1}),fn:(e,t)=>({guard:e,data:t}),greedy:c,name:d}):(j(i)||B("`filter` should be function or unit"),We(n,m,{scope:{fn:i},node:u?[G({fn:({source:e,clock:t},{fn:r})=>r(e,t)}),W({fn:({source:e})=>e})]:[G({fn:Z})],meta:t})),m}function k(e,t,r){if(N(e))return e;if(P(e)){let n,a=ie(e);return x(e)&&(n=d(t,{parent:a,name:e.shortName,"ɔ":r}).on(e,((e,t)=>t))),q(e)&&(n=d(t,{parent:a,name:e.shortName,"ɔ":r}).on(e.done,((e,{result:t})=>t))),a&&a.hooks.store(n),n}let n=Array.isArray(e)?[]:{};return u(e,((e,t)=>{n[t]=N(e)?e:d(e,{name:t})})),n}function b(...e){let t,[[r,n],a]=De(e),o=!n;o&&(t=r.cases,n=r.match,r=r.source);let l=N(n),i=!P(n)&&j(n),c=!l&&!i&&_(n);t||(t={}),o||(c||B("match should be an object"),u(n,((e,r)=>{t[r]=f(a)})),t.__=f(a));let d,p=de(),m=new Set([].concat(r,Object.values(t))),g=Object.keys(l||i?t:n);if(l||i)l&&m.add(n),d=[l&&T({priority:"sampler"}),l&&z({store:ne(n),to:"a"}),G({fn(e,t,r){let a=String(l?r.a:n(e));st(t,Ie(g,a)?a:"__",e,r)}})];else if(c){let e=Q({});e.type="shape";let t,r=e.before=[],a=[z({store:e,to:"a"}),W({fn(e,{key:t},{a:r}){r[t]=e}})],o=[];u(n,((n,l)=>{if(P(n)&&(t=1,o.push(l),m.add(n),We(n,[],{node:a,scope:{key:l}}),N(n))){e.current[l]=n.getState();let t=ne(n);r.push({type:"field",field:l,from:t})}})),t&&p&&p.plain.push(e),d=[t&&T({priority:"sampler"}),t&&z({store:e,to:"a"}),G({fn(e,t,r){for(let a=0;a<g.length;a++){let l=g[a];if(Ie(o,l)?r.a[l]:n[l](e))return void st(t,l,e,r)}st(t,"__",e,r)}})]}else B("expect match to be unit, function or object");if(s({meta:{onCopy:Object.keys(t),op:"split"},parent:r,scope:t,node:d,family:{type:"crosslink",owners:Array.from(m)},regional:1}),!o)return t}let w="undefined"!=typeof Symbol&&Symbol.observable||"@@observable",v="store",S="effect",C="map",P=e=>(j(e)||_(e))&&"kind"in e;const A=e=>t=>P(t)&&t.kind===e;let N=A(v),x=A("event"),q=A(S),M=A("domain"),B=e=>{throw Error(e)},_=e=>"object"==typeof e&&null!==e,j=e=>"function"==typeof e,F=e=>{_(e)||j(e)||B("expect first argument be an object")};const R=()=>{let e=0;return()=>(++e).toString(36)};let U=R(),O=R(),D=R(),I=(e,t)=>e.bind(null,t),$=(e,t,r)=>e.bind(null,t,r);const E=(e,t,r)=>({id:O(),type:e,data:r,hasRef:t});let L=0,T=({priority:e="barrier"})=>E("barrier",0,{barrierID:++L,priority:e}),z=({from:e=v,store:t,target:r,to:n=(r?v:"stack")})=>E("mov",e===v,{from:e,store:t,to:n,target:r}),H={defined:()=>E("check",0,{type:"defined"}),changed:({store:e})=>E("check",1,{type:"changed",store:e})},W=$(E,"compute",0),G=$(E,"filter",0),J=$(E,"run",0),K=({store:e})=>z({from:"stack",target:e}),Q=e=>({id:O(),current:e}),V=({current:e})=>e,X=(e,{fn:t},{a:r})=>t(e,r),Y=(e,{fn:t},{a:r})=>t(r,e),Z=(e,{fn:t})=>t(e),ee=e=>e.graphite||e,te=e=>e.family.owners,re=e=>e.family.links,ne=e=>e.stateRef,ae=e=>e.config,oe=e=>e.ɔ,le=e=>e.value,se=e=>e.subscribers,ie=e=>e.parent,ce=e=>e.forkPage,ue=(e,t)=>{let r=ee(e);for(let n=0;n<t.length;n++){let e=ee(t[n]);"domain"!==r.family.type&&(e.family.type="crosslink"),te(e).push(r),re(r).push(e)}},fe=null,de=()=>fe,pe=e=>(e&&fe&&fe.sidRoot&&(e=`${fe.sidRoot}ɔ${e}`),e);const me=(e=[])=>{let t=[];if(Array.isArray(e))for(let r=0;r<e.length;r++)Array.isArray(e[r])?t.push(...e[r]):t.push(e[r]);else t.push(e);return t.map(ee)};let ge=({hasRef:e,type:t,data:r},n)=>{let a;e&&(a=r.store,n[a.id]=a),"mov"===t&&r.to===v&&(a=r.target,n[a.id]=a)},ye=null;const he=(e,t)=>{if(!e)return t;if(!t)return e;let r,n=e.v.type===t.v.type;return(n&&e.v.id>t.v.id||!n&&"sampler"===e.v.type)&&(r=e,e=t,t=r),r=he(e.r,t),e.r=e.l,e.l=r,e},ke=[];let be=0;for(;be<5;)ke.push({first:null,last:null,size:0}),be+=1;const we=()=>{for(let e=0;e<5;e++){let t=ke[e];if(t.size>0){if(2===e||3===e){t.size-=1;let e=ye.v;return ye=he(ye.l,ye.r),e}1===t.size&&(t.last=null);let r=t.first;return t.first=r.r,t.size-=1,r.v}}},ve=(e,t,r,n,a,o)=>Se(0,{a:null,b:null,node:r,parent:n,value:a,page:t,forkPage:o},e),Se=(e,t,r,n=0)=>{let a=Ce(r),o=ke[a],l={v:{idx:e,stack:t,type:r,id:n},l:0,r:0};2===a||3===a?ye=he(ye,l):(0===o.size?o.first=l:o.last.r=l,o.last=l),o.size+=1},Ce=e=>{switch(e){case"child":return 0;case"pure":return 1;case"barrier":return 2;case"sampler":return 3;case S:return 4;default:return-1}},Pe=new Set;let Ae,Ne=1,xe=0,qe=null,Me=e=>{Ae=e},Be=e=>{qe=e};const _e=(e,t)=>{if(e){for(;e&&!e.reg[t];)e=ie(e);if(e)return e}return null},je=(e,t,r)=>(_e(e,r)||t).reg[r],Fe=(e,{fn:t},r)=>{try{return t(le(r),e.scope,r)}catch(n){console.error(n),e.fail=1}};let Re=(e,t)=>""+e.shortName+t,Ue=(e,t)=>null==t?Re(e," → *"):t,Oe=(e,t)=>{F(e),oe(e)&&t(ae(e),oe(e))},De=e=>{let t;return Oe(e[0],((r,n)=>{t=r,e=n})),[e,t]},Ie=(e,t)=>e.includes(t),$e=(e,t)=>{let r=e.indexOf(t);-1!==r&&e.splice(r,1)};const Ee=(e,t)=>{$e(e.next,t),$e(te(e),t),$e(re(e),t)},Le=(e,t,r)=>{let n;e.next.length=0,e.seq.length=0,e.scope=null;let a=re(e);for(;n=a.pop();)Ee(n,e),(t||r&&!e.meta.sample||"crosslink"===n.family.type)&&Le(n,t,"on"!==n.meta.op&&r);for(a=te(e);n=a.pop();)Ee(n,e),r&&"crosslink"===n.family.type&&Le(n,t,"on"!==n.meta.op&&r)},Te=e=>e.clear();let ze=(e,{deep:t}={})=>{let r=0;if(e.ownerSet&&e.ownerSet.delete(e),N(e))Te(se(e));else if(M(e)){r=1;let t=e.history;Te(t.events),Te(t.effects),Te(t.stores),Te(t.domains)}Le(ee(e),!!t,r)},He=e=>{let t=$(ze,e,void 0);return t.unsubscribe=t,t},We=(e,t,{node:r,scope:n,meta:a})=>s({node:r,parent:e,child:t,scope:n,meta:a,family:{owners:[e,t],links:t},regional:1}),Ge=e=>{let t;Oe(e,((r,n)=>{t=r,e=n}));let{from:r,to:n,meta:a={op:"forward"}}=e;return l(r,"forward",'"from"'),l(n,"forward",'"to"'),t&&(a.config=t),He(s({parent:r,child:n,meta:a,family:{},regional:1}))},Je=(e,t)=>{if(j(t)||B(".watch argument should be a function"),Ae){let t=Ae.nodeMap[ee(e).id];t&&(e=t)}return He(s({scope:{fn:t},node:[J({fn:Z})],parent:e,meta:{op:"watch"},family:{owners:e},regional:1}))};const Ke=(e,t)=>(_(e)&&(Ke(ae(e),t),null!=e.name&&(_(e.name)?Ke(e.name,t):j(e.name)?t.handler=e.name:t.name=e.name),e.loc&&(t.loc=e.loc),(e.sid||null===e.sid)&&(t.sid=e.sid),e.handler&&(t.handler=e.handler),e.updateFilter&&(t.updateFilter=e.updateFilter),ie(e)&&(t.parent=ie(e)),"strict"in e&&(t.strict=e.strict),e.named&&(t.named=e.named),Ke(oe(e),t)),t);let Qe,Ve=(e,t,r="event")=>{ie(e)&&ie(e).hooks[r](t)},Xe=(e,t,r,n)=>{let a=Ke({name:n,config:r},{}),o="domain"===e,l=U(),{parent:s=null,sid:i=null,strict:c=1,named:u=null}=a,f=u||a.name||(o?"":l),d=function(e,t){let r,n,a,o=e;return t?(a=t.compositeName,0===e.length?(r=a.path,n=a.fullName):(r=a.path.concat([e]),n=0===a.fullName.length?e:a.fullName+"/"+e)):(r=0===e.length?[]:[e],n=e),{shortName:o,fullName:n,path:r}}(f,s),p={unit:t.kind=e,name:t.shortName=f,sid:t.sid=pe(i),named:u,unitId:t.id=l};return t.parent=s,t.compositeName=d,t.defaultConfig=a,t.thru=e=>e(t),t.getType=()=>d.fullName,o||(t.subscribe=e=>(F(e),t.watch(j(e)?e:t=>{e.next&&e.next(t)})),t[w]=()=>t),Qe=c,p},Ye=e=>f({named:e});const Ze=(e,t,r,n)=>We(e,t,{scope:{fn:n},node:[W({fn:Z})],meta:{op:r}}),et=(e,t,r,n)=>{let a;_(r)&&(a=r,r=r.fn);let o=f(Re(e," →? *"),a);return We(e,o,{scope:{fn:r},node:n,meta:{op:t}}),o},tt=(e,t,r,n,a,o)=>{let l=ne(t),s=[z({store:l,to:"a"}),W({fn:n?Y:X}),H.defined(),H.changed({store:l}),o&&G({fn:(e,t,{a:r})=>o(e,r)}),K({store:l})];return We(e,t,{scope:{fn:a},node:s,meta:{op:r}})},rt=e=>t=>e(...t),nt=(e,o,l,s)=>{let i=e?e=>e.slice():e=>((e,o)=>{for(var l in o||(o={}))r.call(o,l)&&a(e,l,o[l]);if(t)for(var l of t(o))n.call(o,l)&&a(e,l,o[l]);return e})({},e),f=e?[]:{},p=i(f),m=Q(p),g=Q(1);m.type=e?"list":"shape";let y=d(p,{name:l||c(o)});ee(y).meta.isCombine=1;let h=[H.defined(),z({store:m,to:"a"}),G({fn:(e,{key:t},{a:r})=>e!==r[t]}),z({store:g,to:"b"}),W({fn(e,{clone:t,key:r},n){n.b&&(n.a=t(n.a)),n.a[r]=e}}),z({from:"a",target:m}),z({from:"value",store:0,target:g}),T({priority:"barrier"}),z({from:"value",store:1,target:g}),z({store:m}),s&&W({fn:s}),H.changed({store:ne(y)})],k=m.before=[];return u(o,((e,t)=>{if(!N(e))return void(p[t]=f[t]=e);f[t]=e.defaultState,p[t]=e.getState(),We(e,y,{scope:{key:t,clone:i},node:h,meta:{op:"combine"}});let r=ne(e);k.push({type:"field",field:t,from:r})})),y.defaultShape=o,m.after=[s?{type:C,to:ne(y),fn:s}:{type:"copy",to:ne(y)}],y.defaultState=s?ne(y).current=s(p):f,y};let at=({params:e,req:t,ok:r,anyway:n,stack:a})=>o=>i({target:[n,ot],params:[r?{status:"done",params:e,result:o}:{status:"fail",params:e,error:o},{fn:r?t.rs:t.rj,value:o}],defer:1,page:a.page,forkPage:ce(a)}),ot=s({node:[J({fn({fn:e,value:t}){e(t)}})],meta:{op:"fx",fx:"sidechain"}});const lt=["source","clock","target"],st=(e,t,r,n)=>{let a=e[t];a&&i({target:a,params:Array.isArray(a)?a.map((()=>r)):r,defer:1,stack:n})};var it,ct,ut,ft;(ct=it||(it={}))[ct.Unidentified=0]="Unidentified",ct[ct.SearchPeople=1]="SearchPeople",ct[ct.MyNetwork=2]="MyNetwork",(ft=ut||(ut={})).NextPageButton="button.artdeco-pagination__button--next",ft.ConnectButtonFromMyNetworkPage="div.discover-entity-type-card__bottom-container button.ember-view:enabled:not(.artdeco-button--muted)",ft.ConnectButtonFromSearchPage="li.reusable-search__result-container button.ember-view:enabled:not([data-control-id])",ft.DismissButtonFromSendInviteModal="div.send-invite button.artdeco-modal__dismiss";const dt=f();var pt,mt;(mt=pt||(pt={})).SearchPeoplePage="https://www.linkedin.com/search/results/people/",mt.MyNetworkPage="https://www.linkedin.com/mynetwork/",mt.PatternOfSearchPage="linkedin.com/search/results/people",mt.PatternOfMyNetworkPage="linkedin.com/mynetwork";const gt=f(),{searchPageLoaded:yt,myNetworkPageLoaded:ht,__:kt}=b(gt,{searchPageLoaded:e=>e.includes(pt.PatternOfSearchPage),myNetworkPageLoaded:e=>e.includes(pt.PatternOfMyNetworkPage)}),bt=f(),wt=f(),vt=d(!1).on(bt,(()=>!0)).reset([wt,kt]),St=d(it.Unidentified).on(yt,(()=>it.SearchPeople)).on(ht,(()=>it.MyNetwork)),Ct=m((e=>(window.scrollTo(0,document.body.scrollHeight),document.querySelector(e))));y({clock:h({clock:dt,source:p({isRunning:vt,currentLinkedInPage:St}),filter:({isRunning:e,currentLinkedInPage:t})=>e&&[it.MyNetwork,it.SearchPeople].includes(t)}),fn:({currentLinkedInPage:e})=>e===it.MyNetwork?ut.ConnectButtonFromMyNetworkPage:ut.ConnectButtonFromSearchPage,target:Ct});const Pt=m((e=>{e.focus(),e.click(),e.setAttribute("disabled","disabled")})),At=Pt.done,Nt=m((()=>{var e;null==(e=document.querySelector(ut.DismissButtonFromSendInviteModal))||e.click()})),xt=function(e){let t;Oe(e,((r,n)=>{t=r,e=n}));let{source:r,effect:n,mapParams:a}=e;a||(a=r?(e,t)=>t:e=>e);let o,l=m(e,t),{runner:s}=ee(l).scope,c=({params:e,req:t},{finally:r,effect:n},o)=>{let l,s=at({params:e,req:t,ok:0,anyway:r,stack:o});try{l=a(e,o.a)}catch(c){return s(c)}i({target:n,params:{params:l,req:{rs:at({params:e,req:t,ok:1,anyway:r,stack:o}),rj:s}},page:o.page,defer:1})};if(r){let e;N(r)?(e=r,ue(r,[l])):(e=p(r),ue(l,[e]));let t=z({from:v,store:ne(e),to:"a"});o=[J({fn:e=>e}),t,W({fn:c})],ge(t,s.reg)}else o=[J({fn:c})];return ue(n,[l]),s.scope.effect=n,s.meta.onCopy.push("effect"),s.seq.splice(0,1,...o),Ve(n,l,"effect"),l}({effect:m((e=>new Promise((t=>setTimeout(t,e)))))}),qt=d(0).on(At,(e=>e+1)),Mt=f(),Bt=k(Mt,"100");y({clock:At,target:Nt}),y({clock:At,fn:()=>function(e,t){if(void 0===t&&(t=e,e=0),"number"!=typeof e||"number"!=typeof t)throw new TypeError("Expected all arguments to be numbers");return Math.floor(Math.random()*(t-e+1)+e)}(1500,3e3),target:xt}),h({clock:At,source:p({buttonClicksCount:qt,maximumAutoConnectionsPerSession:Bt}),filter:({buttonClicksCount:e,maximumAutoConnectionsPerSession:t})=>e>=Number(t),target:wt});const _t=m((e=>{const{message:t,port:r}=e;r.postMessage(t)}));var jt,Ft;(Ft=jt||(jt={}))[Ft.ConnectionEstablished=0]="ConnectionEstablished",Ft[Ft.RunningStateUpdated=1]="RunningStateUpdated",Ft[Ft.ButtonClicksCountUpdated=2]="ButtonClicksCountUpdated",Ft[Ft.StartAutoConnect=3]="StartAutoConnect",Ft[Ft.StopAutoConnect=4]="StopAutoConnect";const Rt=f(),Ut=k(Rt,null);h({clock:y({clock:qt.updates,source:Ut,fn:(e,t)=>({message:{id:jt.ButtonClicksCountUpdated,content:t},port:e})}),filter:e=>null!==e.port,target:_t});const Ot=f(),Dt=m((e=>{e.onMessage.addListener((t=>{Ot({message:t,port:e})}))}));Ge({from:Rt,to:Dt}),Ge({from:Rt.map((e=>({message:{id:jt.ConnectionEstablished},port:e}))),to:_t}),y({clock:Rt,source:vt,fn:(e,t)=>({message:{id:jt.RunningStateUpdated,content:e},port:t}),target:_t}),y({clock:Rt,source:qt,fn:(e,t)=>({message:{id:jt.ButtonClicksCountUpdated,content:e},port:t}),target:_t}),Ge({from:xt.doneData,to:dt});const It=b(Ot,{[jt.ConnectionEstablished]:({message:e})=>e.id===jt.ConnectionEstablished,[jt.RunningStateUpdated]:({message:e})=>e.id===jt.RunningStateUpdated,[jt.ButtonClicksCountUpdated]:({message:e})=>e.id===jt.ButtonClicksCountUpdated,[jt.StartAutoConnect]:({message:e})=>e.id===jt.StartAutoConnect,[jt.StopAutoConnect]:({message:e})=>e.id===jt.StopAutoConnect});y({clock:It[jt.StartAutoConnect],target:bt}),y({clock:It[jt.StopAutoConnect],target:wt}),h({clock:vt.updates,filter:e=>e,target:dt}),h({clock:y({clock:vt.updates,source:Ut,fn:(e,t)=>({message:{id:jt.RunningStateUpdated,content:t},port:e})}),filter:e=>null!==e.port,target:_t}),h({clock:ht,filter:vt,target:dt});const{nextAvailableConnectButtonFound:$t,nextAvailableConnectButtonNotFound:Et}=b(Ct.doneData,{nextAvailableConnectButtonFound:e=>null!==e,nextAvailableConnectButtonNotFound:e=>null===e});Ge({from:$t,to:Pt});y({clock:Et,target:m((()=>{var e;null==(e=document.querySelector(ut.NextPageButton))||e.click()}))});const Lt=f(),Tt=k(gt,"");h({clock:Lt,source:Tt,filter:e=>window.location.href!==e,target:gt.prepend((()=>window.location.href))}),h({clock:yt,filter:vt,target:dt});const zt=f(),Ht=m((()=>chrome.runtime.onConnect.addListener(Rt))),Wt=m((()=>setInterval(Lt,1e3))),Gt=m((e=>new Promise((t=>{chrome.storage.sync.get(e,(e=>t(e)))}))));Ge({from:zt,to:[Ht,Wt]}),y({clock:zt,source:p({maximumAutoConnectionsPerSession:Bt}),target:Gt}),y({clock:Gt.doneData,fn:({maximumAutoConnectionsPerSession:e})=>e,target:Mt}),zt();
